<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vanguard V3 | Royal Study</title>
    <style>
        :root { 
            --bg: #120a07; 
            --panel: #1e120c; 
            --accent: #d4af37; 
            --text: #f5e6d3; 
            --tile-light: #d4b483; /* Polished Oak */
            --tile-dark: #4e2a1e;  /* Deep Mahogany */
            --border: #2d1b14;
        }

        body { 
            background: var(--bg); color: var(--text); margin: 0; 
            display: flex; font-family: 'Georgia', serif; height: 100vh; 
            overflow: hidden; align-items: flex-start; 
        }
        
        #sidebar { 
            width: 340px; height: 100vh; background: var(--panel); 
            display: flex; flex-direction: column; padding: 25px; 
            border-right: 4px ridge var(--border); box-sizing: border-box; 
        }

        .header h1 { font-size: 0.8rem; letter-spacing: 6px; color: var(--accent); text-align: center; margin-bottom: 20px; border-bottom: 1px solid var(--accent); padding-bottom: 15px; text-transform: uppercase; }

        #move-log { 
            flex-grow: 1; background: rgba(0,0,0,0.3); 
            border: 1px solid var(--border); border-radius: 4px; 
            padding: 10px; overflow-y: auto; font-family: monospace; 
            font-size: 0.8rem; margin: 15px 0; color: #aaa;
        }

        #game-info { background: #2d1b14; padding: 15px; border-radius: 4px; text-align: center; border: 2px inset var(--border); }
        #timer-box { font-size: 2.2rem; color: var(--accent); font-family: 'Courier New', monospace; font-weight: bold; }

        #canvas-container { 
            flex-grow: 1; height: 100vh; display: flex; 
            justify-content: center; align-items: flex-start;
            padding-top: 25px; 
            background: radial-gradient(circle, #2d1b14 0%, #120a07 100%);
        }

        canvas { border: 12px solid #2d1b14; box-shadow: 0 10px 50px rgba(0,0,0,0.8); cursor: pointer; }
        .btn { background: var(--accent); color: #000; border: none; padding: 12px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 15px; }
    </style>
</head>
<body>
    <div id="sidebar">
        <div class="header"><h1>VANGUARD V3.0</h1></div>
        <div id="game-info">
            <div id="turn-text" style="font-size:0.7rem; color:#888;">OFFLINE</div>
            <div id="timer-box">60s</div>
        </div>
        <div id="move-log"><div>Waiting for deployment...</div></div>
        <button class="btn" onclick="location.reload()">RESET ARENA</button>
    </div>

    <div id="canvas-container"><canvas id="gameCanvas"></canvas></div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playWoodThud() {
        const now = audioCtx.currentTime;
        
        // The "Click" (High frequency contact)
        const click = audioCtx.createOscillator();
        const clickGain = audioCtx.createGain();
        click.type = 'sine';
        click.frequency.setValueAtTime(800, now);
        clickGain.gain.setValueAtTime(0.2, now);
        clickGain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
        
        // The "Thud" (Low frequency board resonance)
        const thud = audioCtx.createOscillator();
        const thudGain = audioCtx.createGain();
        thud.type = 'triangle';
        thud.frequency.setValueAtTime(120, now);
        thud.frequency.exponentialRampToValueAtTime(60, now + 0.1);
        thudGain.gain.setValueAtTime(0.4, now);
        thudGain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);

        click.connect(clickGain); clickGain.connect(audioCtx.destination);
        thud.connect(thudGain); thudGain.connect(audioCtx.destination);
        
        click.start(now); click.stop(now + 0.05);
        thud.start(now); thud.stop(now + 0.15);
    }

    const ROWS = 12, COLS = 16, CELL = 65;
    let board = [], turn = 'w';
    const PIECES = {'wK':'♔','wQ':'♕','wR':'♖','wB':'♗','wN':'♘','wP':'♙','bK':'♚','bQ':'♛','bR':'♜','bB':'♝','bN':'♞','bP':'♟'};

    function logMove(piece, fr, fc, tr, tc) {
        const log = document.getElementById('move-log');
        if (log.innerText.includes('Waiting')) log.innerHTML = '';
        const cols = "abcdefghijklmnop";
        const entry = document.createElement('div');
        entry.style.padding = "4px 0";
        entry.style.borderBottom = "1px solid #2d1b14";
        entry.innerHTML = `<span style="color:${piece[0]==='w'?'#fff':'var(--accent)'}">${PIECES[piece]}</span> ${cols[fc]}${ROWS-fr} → ${cols[tc]}${ROWS-tr}`;
        log.prepend(entry);
    }

    function initBoard() {
        board = Array(ROWS).fill().map(() => Array(COLS).fill(""));
        const layout = ["R","N","B","Q","K","B","N","R"];
        layout.forEach((p, i) => {
            board[2][4+i] = "b"+p; board[3][4+i] = "bP";
            board[9][4+i] = "w"+p; board[8][4+i] = "wP";
        });
    }

    function executeMove(fr, fc, tr, tc) {
        const piece = board[fr][fc];
        logMove(piece, fr, fc, tr, tc);
        playWoodThud();
        board[tr][tc] = piece;
        board[fr][fc] = "";
        turn = (turn === 'w' ? 'b' : 'w');
        render();
    }

    function render() {
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = COLS * CELL; canvas.height = ROWS * CELL;

        for(let r=0; r<ROWS; r++) {
            for(let c=0; c<COLS; c++) {
                ctx.fillStyle = (r+c)%2===0 ? "#d4b483" : "#4e2a1e";
                ctx.fillRect(c*CELL, r*CELL, CELL, CELL);
                if(board[r][c]) {
                    ctx.fillStyle = board[r][c][0] === 'w' ? "#fff" : "#d4af37";
                    ctx.font = "42px serif"; ctx.textAlign = "center";
                    ctx.fillText(PIECES[board[r][c]], c*CELL + CELL/2, r*CELL + CELL/2 + 15);
                }
            }
        }
    }

    initBoard();
    render();

    const canvas = document.getElementById('gameCanvas');
    canvas.addEventListener('mousedown', e => {
        const rect = canvas.getBoundingClientRect();
        const c = Math.floor((e.clientX - rect.left) / CELL);
        const r = Math.floor((e.clientY - rect.top) / CELL);
        if(board[r][c]) executeMove(r, c, r-1, c);
    });
</script>
</body>
</html>
